---
title: Vue.js的设计与实现
date: 2024-11-20 18:42:41
tags: vue
categories: 读书笔记
---
## 第一章 权衡的艺术

### 命令式和声明式

- 命令式框架关注过程 声明式框架关注结果
- 声明式代码的性能不优于命令式代码的性能，但可维护性强

### 虚拟Dom的性能

- 虚拟Dom的意义在于使找出差异的性能消耗最小化
- 虚拟Dom在保证心智负担和可维护性的前提下性能相当不错

### 运行时和编译时

- 纯运行时、纯编译时、运行时+编译时
- Vue3.js是一个编译时+运行时的框架

## 第二章 框架设计的核心要素

### 提升用户的开发体验

- 提供友好的警告信息，帮助用户快速定位问题
- 利用自定义formatter，让输出的信息更友好

### 控制框架代码的体积

### 框架要做到良好的Tree-Shaking

### 框架应该输出怎么样的构建产物

### 特性产物

### 错误处理

### 良好的TypeScript支持

## 第三章 Vue3.js的设计思路

### Vue3的设计思路

- vue3是一个声明式框架
- vue3使用与HTML标签一致的方式来描述Dom元素，属性，事件，层级结构
- vue3支持使用模板和js对象来描述UI

### 虚拟Dom是Vue3的核心

- 虚拟dom是js对象用来描述真实的dom结构
- 渲染器的作用是把虚拟dom渲染为真实dom

### 渲染器的工作原理

- 原理：递归的遍历虚拟dom对象，并调用原生dom api来完成真实dom的创建
- 精髓：通过diff算法找出变更点，并且只更新需要更新的内容

### 组件的本质

- 组件是一组dom元素的封装
    - 组件可以是一个返回的dom函数，也可以是一个对象，但是这个对象下面必须有一个函数用来产出组件要渲染的虚拟dom
    - 渲染器在渲染组件时，会先获取组件要渲染的内容，即执行组件的渲染函数并得到其返回值，我们称之为subtree，最后再递归的调用渲染器将subtree渲染出来即可。

### 模板的工作原理

- vue的模板会被编译器编译为渲染函数
- 无论是使用模板还是直接手写渲染函数，对于一个组件来说，它要渲染的内容最终都是通过渲染函数产生的，然后渲染器再把渲染函数返回的虚拟 DOM 渲染为真实 DOM，这就是模板的工作原理，也是 Vue.js 渲染页面的流程

### Vue是各个模块组成的有机整体